{# This page is opened whenever the surfer opens a new tab, thus indicating they want to go somewhere.

As such I provide some links to places they might likely be trying to go (depicted as recognizable screenshots),
and I take advantage of this page to promote project links. #}
<!DOCTYPE html>
<html>
<head>
  <title>[user-home] {% trans %}New Tab{% endtrans %}</title>
  <style>
    @import url(odysseus:butterick.css);
    main {color: #ddd; text-align: center;}
    main hr {border: none; border-bottom: thin solid #eee; }
    footer {position: fixed; bottom: 0;}
  </style>
</head>
<body>
  <aside style="position: fixed; right: 0; top: 0;"><a href="odysseus:history">
    <img src="gtk-icon:16/document-open-recent" />{% trans %}Browser History{% endtrans %}
  </a></aside>

  <main style="max-width: 720px;"><!-- FIXME ugly code forcing this style --><nav>
    {% query 20 %}
      SELECT uri, order_ FROM topsites_whitelist ORDER BY order_ DESC;
      SELECT uri FROM page_visit
        GROUP BY uri HAVING COUNT(*) >= 20
        ORDER BY COUNT(*) DESC, MAX(visited_at) DESC;
    {% except %}
      SELECT 1 WHERE {{ uri }} NOT IN (SELECT uri FROM topsites_blacklist);
      SELECT 1 WHERE {{ uri }} IN (SELECT uri FROM screenshot_v2);
    {% each-row %}
      <figure style="width: 132px; height: 132px;">
        <a href="{{ uri }}">
          <img {% query %}SELECT image FROM screenshot_v2 WHERE uri = {{ uri }};
                {% each-row %}src="data:image/png;base64,{{ image }}"{% endquery %}
                height="128" width="128" />
        </a>
        <form><input type="hidden" name="$" value="topsites_whitelist" />
          <input type="hidden" name="uri" value="{{ uri }}" />
          <input type="number" name="order_" value="{{ order_ }}" />
          <button type="submit" title="Keep this link on this page.">&check;</button>
        </form>
        <form><input type="hidden" name="$" value="topsites_blacklist" />
          <input type="hidden" name="uri" value="{{ uri }}" />
          <button type="submit" title="Remove this link from this page.">x</button>
        </form>
      </figure>
    {% endquery %}
  </nav></main>

  <footer>{% random %}{% alt %}
      {% trans %}Browse faster with
        <a href="https://alcinnz.github.io/Odysseus-support/guides/keyboard-shortcuts.html">
          keyboard shortcuts</a>!{% endtrans %}
    {% alt %}
      {% trans %}{# Translators: Use this entry to sell your translation project! #}
        Do you know another language? Then do your friends a favour and
        <a href="https://www.transifex.com/none-483/odysseus/dashboard/">teach Odysseus it</a>!{% endtrans %}
    {% alt %}
      {% trans %}Don't know where to go? Here's some
        <a href="https://alcinnz.github.io/Odysseus-recommendations/">recommendations</a>.{% endtrans %}
    {% alt %}
      {% trans %}Want to help
        <a href="https://github.com/alcinnz/Odysseus-support/wiki/Get-Involved!">make Odysseus more awesome</a>?{% endtrans %}
    {% alt %}
      {% trans %}Got questions? Have them <a href="https://alcinnz.github.io/Odysseus-support/">answered</a>.{% endtrans %}
    {% alt %}
      {% trans %}Designed and coded with <a href="odysseus:credits">help</a> & â™¥ by Adrian Lyall Cochrane in NZ.{% endtrans %}
    {% alt %}
      {% trans %}History search not powerful enough for you?
        I <a href="https://alcinnz.github.io/Odysseus-support/guides/how-to-view-history.html">doubt it</a>!{% endtrans %}
    {% alt %}
      {% trans %}While Odysseus does store information about your browsing,
        but that <a href="odysseus:privacy">doesn't mean</a> we share it with anyone but you.{% endtrans %}
    {% alt %}
      {% trans %}Odysseus is <a href="https://liberapay.com/alcinnz/">crowdfunding</a>
        for a server to help gather useful datasets and to better aid localization. Please chip in!{% endtrans %}
  {% alt %}{% endrandom %}</footer>
</body>
</html>
